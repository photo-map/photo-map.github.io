{"version":3,"sources":["Application/components/HelpTip.jsx","Application/utils/gapiRequest.js","Application/utils/gDriveFilesApi.js","Application/helpers/filesListHelpers.js","Application/components/Message/index.jsx","Application/Map/GoogleMap/GoogleMapWrapper.jsx","Application/Map/GoogleMap/GoogleMapCompose.jsx","Application/Map/GoogleMap/PhotoMarker.jsx","Application/Map/GoogleMap/helpers.js","Application/Map/GoogleMap/index.jsx","Application/MenuDrawer/FolderList.jsx","Application/constants.js","Application/Map/helpers.js","Application/Map/index.jsx","Application/Map/AMap/helpers.js","Application/Map/AMap/index.jsx","Application/Map/MapSelector.jsx","Application/MenuDrawer/Title.jsx","Application/helpers/renderGoogleLoginBtn.js","Application/MenuDrawer/GoogleLogin.jsx","Application/config.js","Application/MenuDrawer/helpers.js","Application/MenuDrawer/ConfigSection.jsx","Application/MenuDrawer/index.jsx","Application/init.js","Application/Warning.jsx","Application/index.jsx","serviceWorker.js","index.js"],"names":["HelpTip","props","content","children","title","QuestionCircleOutlined","gapiRequest","requestOpts","Promise","resolve","reject","window","gapi","client","request","execute","resp","filesGet","params","a","path","fileId","filesList","filesFields","join","getFolderInfo","folderId","getPhotosInFolder","q","fields","getPhotoMapFolder","getPhotos","setMediaItems","foldersResp","files","id","Message","message","className","handleClick","event","latLng","console","log","toString","GoogleMapWrapper","defaultZoom","defaultCenter","defaultOptions","mapTypeControlOptions","position","google","maps","ControlPosition","TOP_RIGHT","mapTypeId","ref","refCallback","onClick","debug","debugModule","GoogleMapCompose","compose","withProps","ownerProps","googleMapURL","process","REACT_APP_GOOGLE_MAPS_API_KEY","loadingElement","style","height","containerElement","mapElement","withHandlers","refs","map","undefined","onMapMounted","onMapUnmounted","withScriptjs","withGoogleMap","PhotoMarker","useState","open","setOpen","onCloseClick","src","icon","url","alt","fitMarkers","folders","length","bounds","LatLngBounds","forEach","folder","visible","file","extend","lat","imageMediaMetadata","location","latitude","lng","longitude","fitBounds","GoogleMapComponent","locationGetFromGoogleMap","locationGetFromSateliteImage","GoogleMap","handleMapMounted","handleMapUnmounted","fitMarkersSubscriber","msg","error","addSubscribers","fitMarkersToken","PubSub","subscribe","FIT_MARKERS_TOPIC","removeSubscribers","unsubscribe","renderPhotoMarkers","markers","anchor","x","y","labelOrigin","scaledSize","width","thumbnailLink","push","key","JSON","stringify","this","mapRef","index","markerProps","label","Component","encode","value","folderInfo","decode","parse","localStorage","getItem","FolderList","state","privateFolderVisible","publicFolders","handleChange","checked","target","updatePrivateFolderVisible","publish","SHOW_MARKERS_TOPIC","HIDE_MARKERS_TOPIC","openDrawerToken","addPublicFolderSubscriber","addPublicFolder","setState","setItem","newPublicFolderState","updatePublicFolderVisiable","newState","updateMarkersVisible","removePublicFolder","prevState","filter","removeMarkersInFolder","REMOVE_MARKERS_IN_FOLDER_TOPIC","renderPublicFolders","renderPublicFolder","onChange","folderName","onConfirm","onCancel","okText","cancelText","size","type","getPhotosInPublicFolder","Error","name","getPhotosInPublicFolders","foldersObj","all","Object","keys","addMarkerToAMap","ADD_MARKERS_TOPIC","amapCenter","googleMapCenter","Map","handleMapChange","setMap","handleRenderFinish","handleLoginSuccess","user","privatePhotos","foundPrivateFolder","selectedMap","handleAMapInstanceCreated","AMap","amapLoaded","handleSignedOut","REMOVE_ALL_MARKERS_TOPIC","handleDrawerOpen","OPEN_DRAWER_TOPIC","switchMapToken","switchMapSubscriber","showMarkersToken","showMarkersSubscriber","hideMarkersToken","hideMarkersSubscriber","updateMarkersInFolderVisible","newFolders","onMapInstanceCreated","onRenderFinish","onLoginSuccess","onSignedOut","onMapChange","getMarkersInFolder","markersInFolder","getAllOverlays","marker","getExtData","allMarkers","addMarkersToken","addMarkersSubscriber","removeAllMarkersToken","removeAllMarkersSubscriber","removeMarkersInFolderToken","removeMarkersInFolderSubscriber","data","addMarkers","removeAllMarkers","setFitView","show","hide","genMarker","photo","Marker","lnglat","Icon","Size","image","thumbnail","imageSize","extData","lnglats","convertFrom","status","result","info","locations","resLnglat","webViewLink","on","infoWindow","InfoWindow","offset","Pixel","setContent","getPosition","alert","remove","events","created","instance","click","mapsEvent","lngLat","amapkey","REACT_APP_AMAP_API_KEY","version","center","zoom","radioStyle","display","lineHeight","MapSelector","Group","Title","OutboundLink","eventLabel","to","scopeNeeded","GoogleLogin","gapiAuth2Loaded","signedIn","handleSignOutBtnClick","auth2","getAuthInstance","signOut","then","ReactGA","category","action","renderLoginBtn","googleAuth","isSignedIn","get","renderSignOutBtn","load","init","client_id","scope","attachClickHandler","listen","currentUser","signin2","render","onsuccess","onfailure","b","c","renderGoogleLoginBtn","link2Id","link","replace","exportConfig","storageObj","encodeURIComponent","importConfig","configObj","ConfigSection","handleDownload","href","downloadRef","current","handleImport","inputRef","Response","text","obj","React","createRef","download","MenuDrawer","drawerVisible","publicFolderLink","loading","handleDrawerClose","setVisible","handlePublicFolderLinkChange","handlePublicFolderInputPressEnter","loadPublicFolderAndAddMarkers","handleLoadPublicFolderBtnClick","warn","openDrawerSubscriber","openCloseDrawerSubscriber","openCloseDrawerToken","placement","closable","forceRender","onClose","onPressEnter","disabled","initGa","initialize","registerShortcut","document","addEventListener","code","initGapiClient","Warning","rel","Application","gapiLoaded","gapiClientLoading","initApplication","gapiLoadedFlag","loadGapiClient","Boolean","hostname","match","ReactDOM","getElementById","navigator","serviceWorker","ready","registration","unregister","catch"],"mappings":"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","file":"static/js/main.89223618.chunk.js","sourcesContent":["import React from \"react\";\nimport { Popover } from \"antd\";\nimport { QuestionCircleOutlined } from \"@ant-design/icons\";\n\nexport default function HelpTip(props) {\n  return (\n    <Popover content={props.children} title={null}>\n      <QuestionCircleOutlined />\n    </Popover>\n  );\n}\n","/**\n * Send Google API request\n *\n * @export\n * @param {*} requestOpts\n * @returns\n */\nexport default function gapiRequest(requestOpts) {\n  return new Promise((resolve, reject) => {\n    // https://github.com/google/google-api-javascript-client/blob/master/docs/reference.md#----gapiclientrequestargs--\n    var restRequest = window.gapi.client.request(requestOpts);\n    restRequest.execute((resp) => {\n      resolve(resp);\n    });\n  });\n}\n","import gapiRequest from \"./gapiRequest\";\n\n/**\n * API: https://developers.google.com/drive/api/v3/reference/files/get#request\n * @param {Object} params https://developers.google.com/drive/api/v3/reference/files/get#parameters\n * @returns {Promise<FilesGetResponse>}\n */\nexport const filesGet = async (params) =>\n  await gapiRequest({\n    path: `https://www.googleapis.com/drive/v3/files/${params.fileId}`,\n  });\n\n/**\n * API: https://developers.google.com/drive/api/v3/reference/files/list#request\n * @returns {Promise<FilesListResponse>}\n */\nexport const filesList = async (params) =>\n  await gapiRequest({\n    path: \"https://www.googleapis.com/drive/v3/files\",\n    params,\n  });\n","import { filesGet, filesList } from \"../utils/gDriveFilesApi\";\n\nconst filesFields = [\n  \"files/imageMediaMetadata/location\",\n  \"files/thumbnailLink\",\n  \"files/webContentLink\", // original photo link, can used in <img> tag\n  \"files/webViewLink\", // Google Drive link to preview this photo.\n].join(\",\");\n\n// Sample response:\n// {\n//   id: \"1nem5ZFB1xj3NuLT3aknYs7z4KTk6Cya6\"\n//   kind: \"drive#file\"\n//   mimeType: \"application/vnd.google-apps.folder\"\n//   name: \"2020-05-21 莲石湖公园\"\n// }\nexport const getFolderInfo = async (folderId) =>\n  await filesGet({\n    fileId: folderId,\n  });\n\n/**\n * Get all photos in a folder\n * @todo Filter out the response, leave only the photos with GPS locations,\n *       maybe popup some warning about photos without GPS locations.\n */\nexport const getPhotosInFolder = async (folderId) =>\n  await filesList({\n    q: `'${folderId}' in parents and (mimeType='image/jpeg' or mimeType='image/png')`, // get files in this folder\n    // fields: \"files/*\", // debug\n    fields: filesFields, // location and photo link\n  });\n\n/**\n * resp = {\n *   files: [{\n *     \"kind\": \"drive#file\",\n *     \"id\": \"1Kv...MF\",\n *     \"name\": \"Photo Map\",\n *     \"mimeType\": \"application/vnd.google-apps.folder\"\n *   }]\n * }\n */\nconst getPhotoMapFolder = async () =>\n  await filesList({\n    // Find resource name is \"Photo Map\", type is folder\n    q: \"name='Photo Map' and mimeType='application/vnd.google-apps.folder'\",\n  });\n\n/**\n * @export\n * @returns Promise<Files[]> Files type: https://developers.google.com/drive/api/v3/reference/files\n */\nexport const getPhotos = async (setMediaItems) => {\n  const foldersResp = await getPhotoMapFolder();\n  const folderId = foldersResp.files[0].id;\n  const resp = await getPhotosInFolder(folderId);\n  // resp: {\n  //   \"files\": [\n  //     {\n  //       \"thumbnailLink\": \"https://lh3.googleusercontent.com/rSd...220\",\n  //       \"imageMediaMetadata\": {\n  //         \"location\": {\n  //           \"latitude\": 1,\n  //           \"longitude\": 103,\n  //           \"altitude\": 456\n  //         }\n  //       }\n  //     }\n  //   ]\n  // }\n  return resp.files;\n};\n","import React from \"react\";\nimport \"./index.css\";\n\nexport default function Message(props) {\n  const { message } = props;\n  if (!message) {\n    return null;\n  }\n  return (\n    <div className=\"message-wrapper\">\n      <div className=\"message-body\">\n        <span className=\"message-content\">{message}</span>\n      </div>\n    </div>\n  );\n}\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { GoogleMap } from \"react-google-maps\";\n\n/**\n * google.maps.LatLng\n * @typedef {Object} LatLng\n */\n\n/**\n * This object is returned from various mouse events on the map and overlays, and contains all the fields shown below.\n * Checkout the {@link https://developers.google.com/maps/documentation/javascript/reference/map#MouseEvent API document}\n * @typedef {Object} MouseEvent\n * @property {LatLng} latLng\n */\n\n/**\n * Checkout the {@link https://developers.google.com/maps/documentation/javascript/reference/map#Map.click API document} for this \"click\" event\n * @param {MouseEvent} event\n */\nfunction handleClick(event) {\n  // @type {LatLng} https://developers.google.com/maps/documentation/javascript/reference/coordinates#LatLng\n  const { latLng } = event;\n  console.log(`You click on the Google Maps, latLng: ${latLng.toString()}`);\n}\n\nconst GoogleMapWrapper = (props) => (\n  <GoogleMap\n    defaultZoom={props.defaultZoom}\n    defaultCenter={props.defaultCenter}\n    defaultOptions={{\n      mapTypeControlOptions: {\n        // style: window.google.maps.MapTypeControlStyle.HORIZONTAL_BAR,\n        position: window.google.maps.ControlPosition.TOP_RIGHT,\n      },\n    }}\n    mapTypeId=\"satellite\"\n    ref={props.refCallback}\n    onClick={handleClick}\n  >\n    {props.children}\n  </GoogleMap>\n);\n\nGoogleMapWrapper.propTypes = {\n  onMapMounted: PropTypes.func.isRequired,\n  onMapUnmounted: PropTypes.func.isRequired,\n};\n\nexport default GoogleMapWrapper;\n","import React from \"react\";\nimport { compose, withProps, withHandlers } from \"recompose\";\nimport { withScriptjs, withGoogleMap } from \"react-google-maps\";\nimport debugModule from \"debug\";\n\nconst debug = debugModule(\n  \"photo-map:src/Application/Map/GoogleMap/GoogleMapCompose.jsx\"\n);\n\nconst GoogleMapCompose = compose(\n  withProps((ownerProps) => ({\n    googleMapURL: `https://maps.googleapis.com/maps/api/js?key=${process.env.REACT_APP_GOOGLE_MAPS_API_KEY}&v=3.exp&libraries=geometry,drawing,places`,\n    loadingElement: <div style={{ height: \"100%\" }} />,\n    containerElement: <div style={{ height: \"100vh\" }} />,\n    mapElement: <div style={{ height: \"100%\" }} />,\n  })),\n  withHandlers((ownerProps) => {\n    const refs = {\n      map: undefined,\n    };\n\n    return {\n      /**\n       * React will call the `ref` callback with the DOM element when the component mounts,\n       * and call it with `null` when it unmounts.\n       * @see https://reactjs.org/docs/refs-and-the-dom.html\n       */\n      refCallback: () => (ref) => {\n        debug(\"refCallback()()\", ref);\n        refs.map = ref;\n\n        if (ref === null) {\n          ownerProps.onMapUnmounted();\n          return;\n        }\n        ownerProps.onMapMounted(ref);\n      },\n      // onZoomChanged: ({ onZoomChange }) => () => {\n      //   onZoomChange(refs.map.getZoom())\n      // }\n    };\n  }),\n  withScriptjs,\n  withGoogleMap\n);\n\nexport default GoogleMapCompose;\n","import React, { useState } from \"react\";\nimport { Marker, InfoWindow } from \"react-google-maps\";\n\nexport default function PhotoMarker(props) {\n  const [open, setOpen] = useState(false);\n\n  return (\n    <Marker {...props} onClick={() => setOpen(true)}>\n      {open && (\n        <InfoWindow onCloseClick={() => setOpen(false)}>\n          <div>\n            <img src={props.icon.url} alt=\"Photos\" />\n          </div>\n        </InfoWindow>\n      )}\n    </Marker>\n  );\n}\n","export const fitMarkers = (map, folders) => {\n  if (folders.length === 0) {\n    return;\n  }\n\n  // @type {google.maps.LatLngBounds} https://developers.google.com/maps/documentation/javascript/reference/coordinates#LatLngBounds\n  const bounds = new window.google.maps.LatLngBounds();\n\n  folders.forEach((folder) => {\n    if (folder.visible === false) return;\n    folder.files.forEach((file) => {\n      // extend(point), point is type of LatLng\n      bounds.extend({\n        lat: file.imageMediaMetadata.location.latitude,\n        lng: file.imageMediaMetadata.location.longitude,\n      });\n    });\n  });\n\n  map.fitBounds(bounds);\n};\n","import React, { Component } from \"react\";\nimport { Marker } from \"react-google-maps\";\nimport PubSub from \"pubsub-js\";\nimport debugModule from \"debug\";\n\nimport { FIT_MARKERS_TOPIC } from \"../\";\nimport GoogleMapWrapper from \"./GoogleMapWrapper\";\nimport GoogleMapCompose from \"./GoogleMapCompose\";\nimport PhotoMarker from \"./PhotoMarker\";\nimport { fitMarkers } from \"./helpers\";\n// import { photoMarker, photoMarker2 } from \"../markers.jsx\";\n\nconst debug = debugModule(\"photo-map:src/Application/Map/GoogleMap/index.jsx\");\nconst GoogleMapComponent = GoogleMapCompose(GoogleMapWrapper);\n\nconst locationGetFromGoogleMap = {\n  lat: 39.873806,\n  lng: 116.22555,\n};\nconst locationGetFromSateliteImage = {\n  lat: 39.872542,\n  lng: 116.219536,\n};\n// const latOffset =locationGetFromGoogleMap.lat-locationGetFromSateliteImage.lat\n// const lngOffset =locationGetFromGoogleMap.lng-locationGetFromSateliteImage.lng\n\n/**\n * Marker - https://developers.google.com/maps/documentation/javascript/markers\n *\n * @param {*} props\n * @returns\n */\n// function GoogleMap(props) {\n\n// }\nclass GoogleMap extends Component {\n  componentDidMount() {\n    this.addSubscribers();\n  }\n\n  componentWillUnmount() {\n    this.removeSubscribers();\n  }\n\n  handleMapMounted = (map) => {\n    debug(\"handleMapMounted()\", map);\n    this.map = map;\n\n    fitMarkers(map, this.props.folders);\n  };\n\n  handleMapUnmounted = () => {\n    debug(\"handleMapUnmounted()\");\n  };\n\n  fitMarkersSubscriber = (msg) => {\n    debug(\"fitMarkersSubscriber()\", msg);\n\n    if (!this.map) {\n      console.error(\"this.map of Google Map is undefined!\");\n      return;\n    }\n\n    fitMarkers(this.map, this.props.folders);\n  };\n\n  addSubscribers = () => {\n    this.fitMarkersToken = PubSub.subscribe(\n      FIT_MARKERS_TOPIC,\n      this.fitMarkersSubscriber\n    );\n  };\n\n  removeSubscribers = () => {\n    PubSub.unsubscribe(this.fitMarkersToken);\n  };\n\n  renderPhotoMarkers = () => {\n    const markers = [];\n    this.props.folders.forEach((folder) => {\n      if (folder.visible === false) return;\n      folder.files.forEach((file) => {\n        const icon = {\n          anchor: { x: 0, y: 0 },\n          labelOrigin: { x: 0, y: 0 },\n          // origin: {x:0,y:0},\n          scaledSize: {\n            // img size\n            height: 64,\n            width: 64,\n          },\n          // size: { // div size\n          //   height: 100,\n          //   width: 200,\n          // },\n          url: file.thumbnailLink,\n        }; /* Icon */\n        markers.push(\n          <PhotoMarker\n            key={JSON.stringify(file)}\n            position={\n              {\n                lat: file.imageMediaMetadata.location.latitude,\n                lng: file.imageMediaMetadata.location.longitude,\n              } /* LatLngLiteral */\n            }\n            icon={icon}\n          />\n        );\n      });\n    });\n    return markers;\n  };\n\n  render() {\n    debug(\"render()\", this.props);\n    const { defaultZoom, defaultCenter, markers } = this.props;\n\n    return (\n      <GoogleMapComponent\n        ref={this.mapRef}\n        defaultZoom={defaultZoom}\n        defaultCenter={defaultCenter}\n        onMapMounted={this.handleMapMounted}\n        onMapUnmounted={this.handleMapUnmounted}\n      >\n        {markers.map(({ ...markerProps }, index) => {\n          return <Marker key={index} {...markerProps}></Marker>;\n        })}\n        <Marker label=\"Map\" position={locationGetFromGoogleMap} />\n        <Marker label=\"Satelite\" position={locationGetFromSateliteImage} />\n        {/*<PhotoMarker {...photoMarker} />\n      <PhotoMarker {...photoMarker2} />*/}\n        {this.renderPhotoMarkers()}\n      </GoogleMapComponent>\n    );\n  }\n}\n\nexport default GoogleMap;\n","import React, { Component } from \"react\";\nimport { Checkbox, Button, Popconfirm } from \"antd\";\nimport PubSub from \"pubsub-js\";\nimport debugModule from \"debug\";\n\nimport {\n  SHOW_MARKERS_TOPIC,\n  HIDE_MARKERS_TOPIC,\n  REMOVE_MARKERS_IN_FOLDER_TOPIC,\n} from \"../Map/AMap\";\nimport { PRIVATE_FOLDER_ID } from \"../constants\";\n\nconst debug = debugModule(\n  \"photo-map:src/Application/MenuDrawer/FolderList.jsx\"\n);\n\nexport const ADD_PUBLIC_FOLDER_TOPIC = \"publicfolder.add\";\nexport const localStorageKeyPublicFolders = \"pmap:publicFolders\";\nexport const localStorageKeyPrivateFolderVisible = \"pmap:privateFolderVisible\";\n\n// Encode the public folders state to save in localStorage\n// React state --(encode)-> localStorage\nexport const encode = (value) => {\n  const content = {};\n  value.forEach((folderInfo) => {\n    content[folderInfo.folderId] = folderInfo.visible;\n  });\n  return JSON.stringify(content);\n};\n// Decode the public folders content in localStorage to save to state\n// localStorage --(decode)-> React state\nexport const decode = () => {\n  return JSON.parse(localStorage.getItem(localStorageKeyPublicFolders));\n};\n\nexport default class FolderList extends Component {\n  state = {\n    // Whether to show photos in the private folder.\n    privateFolderVisible: true,\n    // The folder id, name and visible of public folders.\n    // The key is folder ID from https://drive.google.com/drive/folders/13s5wep_gYYVCroQcFB6nJHMWz8V2Onsr?usp=sharing\n    // [\n    //   {folderId:\"13s5wep_gYYVCroQcFB6nJHMWz8V2Onsr\",visible:true,name:\"Dog Photos\"}\n    // ]\n    publicFolders: [],\n  };\n\n  componentDidMount() {\n    this.addSubscribers();\n\n    // Load state from localStorage\n    this.setState({\n      privateFolderVisible:\n        localStorage.getItem(localStorageKeyPrivateFolderVisible) === \"true\",\n    });\n  }\n\n  componentWillUnmount() {\n    this.removeSubscribers();\n  }\n\n  handleChange = (event) => {\n    const { checked } = event.target;\n    this.updatePrivateFolderVisible(checked);\n    PubSub.publish(checked ? SHOW_MARKERS_TOPIC : HIDE_MARKERS_TOPIC, {\n      folderId: PRIVATE_FOLDER_ID,\n    });\n  };\n\n  addSubscribers = () => {\n    this.openDrawerToken = PubSub.subscribe(\n      ADD_PUBLIC_FOLDER_TOPIC,\n      this.addPublicFolderSubscriber\n    );\n  };\n\n  removeSubscribers = () => {\n    PubSub.unsubscribe(this.openDrawerToken);\n  };\n\n  addPublicFolderSubscriber = (msg, folderInfo) => {\n    this.addPublicFolder(folderInfo);\n  };\n\n  updatePrivateFolderVisible = (visible) => {\n    this.setState({ privateFolderVisible: visible });\n    localStorage.setItem(localStorageKeyPrivateFolderVisible, visible);\n  };\n\n  /**\n   * @param {FolderInfo} folderInfo\n   * @memberof FolderList\n   */\n  addPublicFolder = (folderInfo) => {\n    const { publicFolders } = this.state;\n    const newPublicFolderState = [...publicFolders, folderInfo];\n    this.setState({\n      publicFolders: newPublicFolderState,\n    });\n    localStorage.setItem(\n      localStorageKeyPublicFolders,\n      encode(newPublicFolderState)\n    );\n  };\n\n  updatePublicFolderVisiable = (folderId, visible) => {\n    const { publicFolders } = this.state;\n    const newState = [...publicFolders];\n    newState.forEach((folderInfo, index) => {\n      if (folderInfo.folderId === folderId) {\n        newState[index] = { ...folderInfo, visible };\n      }\n    });\n    this.setState({\n      publicFolders: newState,\n    });\n    localStorage.setItem(localStorageKeyPublicFolders, encode(newState));\n  };\n\n  updateMarkersVisible = (visible, folderId) => {\n    PubSub.publish(visible ? SHOW_MARKERS_TOPIC : HIDE_MARKERS_TOPIC, {\n      folderId,\n    });\n  };\n\n  removePublicFolder = (folderId) => {\n    this.setState((prevState) => {\n      const newState = prevState.publicFolders.filter(\n        (folderInfo) => folderInfo.folderId !== folderId\n      );\n      localStorage.setItem(localStorageKeyPublicFolders, encode(newState));\n      return { publicFolders: newState };\n    });\n  };\n\n  removeMarkersInFolder = (folderId) => {\n    PubSub.publish(REMOVE_MARKERS_IN_FOLDER_TOPIC, {\n      folderId,\n    });\n  };\n\n  renderPublicFolders = () => {\n    const { publicFolders } = this.state;\n\n    if (publicFolders.length === 0) {\n      return \"No data\";\n    }\n\n    return publicFolders.map(this.renderPublicFolder);\n  };\n\n  renderPublicFolder = (folderInfo) => {\n    const { folderId } = folderInfo;\n    const handleChange = (event) => {\n      this.updatePublicFolderVisiable(folderId, event.target.checked);\n      this.updateMarkersVisible(event.target.checked, folderId);\n    };\n\n    const handleDelete = () => {\n      this.removePublicFolder(folderId);\n      this.removeMarkersInFolder(folderId);\n    };\n\n    return (\n      <div key={folderInfo.folderId}>\n        <Checkbox checked={folderInfo.visible} onChange={handleChange}>\n          {folderInfo.folderName} : {folderInfo.folderId}{\" \"}\n          <Popconfirm\n            title=\"Are you sure delete this folder?\"\n            onConfirm={handleDelete}\n            onCancel={() => {}}\n            okText=\"Yes\"\n            cancelText=\"No\"\n          >\n            <Button size=\"small\" type=\"danger\">\n              Del\n            </Button>\n          </Popconfirm>\n        </Checkbox>\n      </div>\n    );\n  };\n\n  render() {\n    debug(\"render()\", this.props, this.state);\n\n    return (\n      <div>\n        <div>\n          <h3>Private folder in Google Drive</h3>\n          <Checkbox\n            checked={this.state.privateFolderVisible}\n            onChange={this.handleChange}\n          >\n            \"Photo Map\" folder in Google Drive of the login user\n          </Checkbox>\n        </div>\n        <div>\n          <h3>Public folder in Google Drive</h3>\n          {this.renderPublicFolders()}\n        </div>\n      </div>\n    );\n  }\n}\n","export const GOOGLE_MAP = \"google\";\nexport const A_MAP = \"amap\";\nexport const DEFAULT_SELECTED_MAP = A_MAP;\n\nexport const PRIVATE_FOLDER_ID = \"__privateFolderId__\";\n","import PubSub from \"pubsub-js\";\n\nimport { getFolderInfo, getPhotosInFolder } from \"../helpers/filesListHelpers\";\nimport {\n  localStorageKeyPrivateFolderVisible,\n  localStorageKeyPublicFolders,\n} from \"../MenuDrawer/FolderList\";\nimport { ADD_MARKERS_TOPIC } from \"./AMap\";\nimport { PRIVATE_FOLDER_ID } from \"../constants\";\n\nexport const getPhotosInPublicFolder = async (folderId) => {\n  const folderInfo = await getFolderInfo(folderId);\n  // Get photos from public folder\n  const resp = await getPhotosInFolder(folderId);\n  if (resp.error) {\n    console.error(\"Failed to get photos in a public folders, response:\", resp);\n    throw new Error(resp.error.message);\n  }\n  return {\n    files: resp.files,\n    visible: true,\n    folderId,\n    folderName: folderInfo.name,\n  };\n};\n\nexport const getPhotosInPublicFolders = async () => {\n  const foldersObj = JSON.parse(\n    localStorage.getItem(localStorageKeyPublicFolders)\n  );\n  if (!foldersObj) {\n    return [];\n  }\n  return await Promise.all(\n    Object.keys(foldersObj).map(async (folderId) => {\n      return await getPhotosInPublicFolder(folderId);\n    })\n  );\n};\n\nexport const addMarkerToAMap = async (files) => {\n  PubSub.publish(ADD_MARKERS_TOPIC, {\n    files,\n    visible:\n      localStorage.getItem(localStorageKeyPrivateFolderVisible) === \"true\",\n    folderId: PRIVATE_FOLDER_ID,\n  });\n\n  const folders = await getPhotosInPublicFolders();\n  folders.forEach((folder) => PubSub.publish(ADD_MARKERS_TOPIC, folder));\n};\n","import React, { Component } from \"react\";\nimport { Button } from \"antd\";\nimport PubSub from \"pubsub-js\";\nimport debugModule from \"debug\";\n\nimport {\n  GOOGLE_MAP,\n  A_MAP,\n  DEFAULT_SELECTED_MAP,\n  PRIVATE_FOLDER_ID,\n} from \"../constants\";\nimport { getPhotos } from \"../helpers/filesListHelpers\";\nimport Message from \"../components/Message\";\nimport GoogleMap from \"./GoogleMap\";\n// import { simpleMarker } from \"./markers\";\nimport AMap, { REMOVE_ALL_MARKERS_TOPIC } from \"./AMap\";\nimport MenuDrawer, { OPEN_DRAWER_TOPIC } from \"../MenuDrawer\";\nimport { ADD_PUBLIC_FOLDER_TOPIC } from \"../MenuDrawer/FolderList\";\nimport { getPhotosInPublicFolders, addMarkerToAMap } from \"./helpers\";\n\nconst debug = debugModule(\"photo-map:src/Application/Map/index.jsx\");\n\nconst amapCenter = { latitude: 39.871446, longitude: 116.215768 };\nconst googleMapCenter = { lat: 39.871446, lng: 116.215768 };\n\nexport const localStorageKeySelectedMap = \"pmap::selectedMap\";\nexport const SWITCH_MAP_TOPIC = \"map.switchmap\";\nexport const SHOW_MARKERS_TOPIC = \"amap.showmarkers\";\nexport const HIDE_MARKERS_TOPIC = \"amap.hidemarkers\";\n// Fitbounds to the markers showing on the map\nexport const FIT_MARKERS_TOPIC = \"googlemap.fitmarkers\";\n\nexport default class Map extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      // Folders in GDrive which contains photos\n      // [\n      //   {\"folderId\":\"\", \"files\":\"\"},\n      //   {\"folderId\":\"\", \"files\":\"\"}\n      // ]\n      folders: [],\n      amapLoaded: false,\n      message: \"Rendering Google login button...\",\n    };\n\n    this.state.selectedMap =\n      localStorage.getItem(localStorageKeySelectedMap) || DEFAULT_SELECTED_MAP;\n  }\n\n  componentDidMount() {\n    this.addSubscribers();\n  }\n\n  componentWillUnmount() {\n    this.removeSubscribers();\n  }\n\n  handleMapChange = (name) => {\n    this.setMap(name);\n  };\n\n  // GoogleLogin button render finished\n  handleRenderFinish = () => {\n    this.setState({ message: \"\" });\n  };\n\n  /**\n   * User success signed in Google account.\n   * @param {gapi.auth2.GoogleUser} user\n   */\n  handleLoginSuccess = async (user) => {\n    debug(\"handleLoginSuccess\", user);\n\n    this.setState({\n      message: \"Login successfully, try to load photos in Google Drive...\",\n    });\n\n    // Load photos in private folder of login user's Google Drive\n    const privatePhotos = await getPhotos();\n\n    this.setState({\n      message: \"\",\n    });\n\n    // Update private folder in state\n    let foundPrivateFolder = false;\n    const folders = this.state.folders.map((folder) => {\n      if (folder.folderId === PRIVATE_FOLDER_ID) {\n        foundPrivateFolder = true;\n        folder.files = privatePhotos;\n      }\n      return folder;\n    });\n    if (!foundPrivateFolder) {\n      folders.push({\n        folderId: PRIVATE_FOLDER_ID,\n        files: privatePhotos,\n      });\n    }\n    this.setState({ folders });\n\n    // Update public folder in state\n    const publicFolders = await getPhotosInPublicFolders();\n    this.setState({\n      folders: [...this.state.folders, ...publicFolders],\n    });\n    publicFolders.forEach((folderInfo) => {\n      PubSub.publish(ADD_PUBLIC_FOLDER_TOPIC, folderInfo);\n    });\n\n    if (this.state.selectedMap === \"amap\") {\n      await addMarkerToAMap(privatePhotos);\n    }\n\n    PubSub.publish(FIT_MARKERS_TOPIC);\n  };\n\n  handleAMapInstanceCreated = () => {\n    debug(\"handleAMapInstanceCreated()\", window.AMap);\n    this.setState({ amapLoaded: true });\n  };\n\n  handleSignedOut = () => {\n    this.setState({\n      folders: [],\n    });\n    PubSub.publish(REMOVE_ALL_MARKERS_TOPIC);\n  };\n\n  handleDrawerOpen = () => {\n    PubSub.publish(OPEN_DRAWER_TOPIC);\n  };\n\n  addSubscribers = () => {\n    this.switchMapToken = PubSub.subscribe(\n      SWITCH_MAP_TOPIC,\n      this.switchMapSubscriber\n    );\n    this.showMarkersToken = PubSub.subscribe(\n      SHOW_MARKERS_TOPIC,\n      this.showMarkersSubscriber\n    );\n    this.hideMarkersToken = PubSub.subscribe(\n      HIDE_MARKERS_TOPIC,\n      this.hideMarkersSubscriber\n    );\n  };\n\n  removeSubscribers = () => {\n    PubSub.unsubscribe(this.switchMapToken);\n  };\n\n  switchMapSubscriber = () => {\n    this.setMap(this.state.selectedMap === A_MAP ? GOOGLE_MAP : A_MAP);\n  };\n\n  showMarkersSubscriber = (msg, filter) => {\n    this.updateMarkersInFolderVisible(filter.folderId, true);\n  };\n\n  hideMarkersSubscriber = (msg, filter) => {\n    this.updateMarkersInFolderVisible(filter.folderId, false);\n  };\n\n  updateMarkersInFolderVisible = (folderId, visible) => {\n    const newFolders = this.state.folders.map((folder) => {\n      if (folder.folderId === folderId) {\n        folder.visible = visible;\n      }\n      return folder;\n    });\n    this.setState({ folder: newFolders });\n  };\n\n  setMap = (name) => {\n    this.setState({\n      selectedMap: name,\n    });\n    localStorage.setItem(localStorageKeySelectedMap, name);\n  };\n\n  render() {\n    const { selectedMap, folders, message } = this.state;\n\n    let map = null;\n    if (selectedMap === A_MAP) {\n      map = (\n        <AMap\n          defaultCenter={amapCenter}\n          defaultZoom={16}\n          onMapInstanceCreated={this.handleAMapInstanceCreated}\n        />\n      );\n    } else if (selectedMap === GOOGLE_MAP) {\n      map = (\n        <GoogleMap\n          defaultZoom={16}\n          defaultCenter={googleMapCenter}\n          markers={\n            [\n              /*simpleMarker*/\n            ]\n          }\n          folders={folders}\n        />\n      );\n    }\n\n    return (\n      <div className=\"map-wrapper\">\n        <Message message={message} />\n        {map}\n        <div className=\"menu-btn-wrapper\">\n          <Button onClick={this.handleDrawerOpen}>Menu</Button>\n        </div>\n        <MenuDrawer\n          selectedMap={selectedMap}\n          onRenderFinish={this.handleRenderFinish}\n          onLoginSuccess={this.handleLoginSuccess}\n          onSignedOut={this.handleSignedOut}\n          onMapChange={this.handleMapChange}\n        />\n      </div>\n    );\n  }\n}\n","export const getMarkersInFolder = (map, folderId) => {\n  const markersInFolder = [];\n  const markers = map.getAllOverlays(\"marker\");\n  markers.forEach((marker) => {\n    if (marker.getExtData().folderId === folderId) {\n      markersInFolder.push(marker);\n    }\n  });\n  return markersInFolder;\n};\n","import React, { Component } from \"react\";\nimport { Map } from \"react-amap\";\nimport PubSub from \"pubsub-js\";\nimport debugModule from \"debug\";\n\nimport { FIT_MARKERS_TOPIC } from \"../\";\nimport { getMarkersInFolder } from \"./helpers\";\n\nimport \"./index.css\";\n\nconst debug = debugModule(\"photo-map:src/Application/Map/AMap/index.jsx\");\n\nexport const ADD_MARKERS_TOPIC = \"amap.addmarkers\";\nexport const REMOVE_ALL_MARKERS_TOPIC = \"amap.removeallmarkers\";\nexport const REMOVE_MARKERS_IN_FOLDER_TOPIC = \"amap.removemarkersinfolder\";\nexport const SHOW_MARKERS_TOPIC = \"amap.showmarkers\";\nexport const HIDE_MARKERS_TOPIC = \"amap.hidemarkers\";\n\n/**\n * AMap\n * @export\n * @class AMap\n * @extends {Component}\n *\n * How to use AMap API\n * ```js\n * const {map} = this.aMapRef.current\n * // map.getAllOverlays()\n * // map.setFitView()\n * ```\n */\nexport default class AMap extends Component {\n  // AMap instance\n  map = null;\n  // An array of AMap.Marker instances\n  allMarkers = [];\n\n  componentDidMount() {\n    this.addSubscribers();\n  }\n\n  componentWillUnmount() {\n    this.removeSubscribers();\n  }\n\n  addSubscribers = () => {\n    this.addMarkersToken = PubSub.subscribe(\n      ADD_MARKERS_TOPIC,\n      this.addMarkersSubscriber\n    );\n    this.removeAllMarkersToken = PubSub.subscribe(\n      REMOVE_ALL_MARKERS_TOPIC,\n      this.removeAllMarkersSubscriber\n    );\n    this.removeMarkersInFolderToken = PubSub.subscribe(\n      REMOVE_MARKERS_IN_FOLDER_TOPIC,\n      this.removeMarkersInFolderSubscriber\n    );\n    this.showMarkersToken = PubSub.subscribe(\n      SHOW_MARKERS_TOPIC,\n      this.showMarkersSubscriber\n    );\n    this.hideMarkersToken = PubSub.subscribe(\n      HIDE_MARKERS_TOPIC,\n      this.hideMarkersSubscriber\n    );\n    this.fitMarkersToken = PubSub.subscribe(\n      FIT_MARKERS_TOPIC,\n      this.fitMarkersSubscriber\n    );\n  };\n\n  removeSubscribers = () => {\n    PubSub.unsubscribe(this.addMarkersToken);\n    PubSub.unsubscribe(this.removeAllMarkersToken);\n    PubSub.unsubscribe(this.removeMarkersInFolderToken);\n    PubSub.unsubscribe(this.showMarkersToken);\n    PubSub.unsubscribe(this.hideMarkersToken);\n  };\n\n  addMarkersSubscriber = (msg, data) => {\n    this.addMarkers(data.files, data.visible, data.folderId);\n  };\n\n  removeMarkersInFolderSubscriber = (msg, data) => {\n    this.removeMarkersInFolder(data.folderId);\n  };\n\n  removeAllMarkersSubscriber = (msg) => {\n    this.removeAllMarkers();\n  };\n\n  showMarkersSubscriber = (msg, filter) => {\n    this.updateMarkersInFolderVisible(filter.folderId, true);\n  };\n\n  hideMarkersSubscriber = (msg, filter) => {\n    this.updateMarkersInFolderVisible(filter.folderId, false);\n  };\n\n  fitMarkersSubscriber = (msg) => {\n    if (!this.map) {\n      console.error(\"this.map of AMap is undefined!\");\n      return;\n    }\n\n    // Fitbounds to all the markers\n    this.map.setFitView();\n  };\n\n  updateMarkersInFolderVisible = (folderId, visible) => {\n    getMarkersInFolder(this.map, folderId).forEach((marker) => {\n      if (visible) {\n        marker.show();\n      } else {\n        marker.hide();\n      }\n    });\n\n    // Fitbounds to all the markers\n    this.map.setFitView();\n  };\n\n  genMarker = (photo, folderId, visible) =>\n    new window.AMap.Marker({\n      map: this.map,\n      visible,\n      position: photo.lnglat,\n      icon: new window.AMap.Icon({\n        // width/height used in <div> tag which wraps the <img> tag\n        size: new window.AMap.Size(64, 64),\n        image: photo.thumbnail,\n        // width/height used in <img> tag\n        imageSize: new window.AMap.Size(64, 64),\n        // 图标取图偏移量\n        // imageOffset: new AMap.Pixel(-9, -3)\n      }),\n\n      // 设置了 icon 以后，设置 icon 的偏移量，以 icon 的 [center bottom] 为原点\n      // offset: new AMap.Pixel(-13, -30)\n\n      extData: {\n        // folderId=\"__privateFolderId__\" // private folder, because this id will change, we will not use this id\n        // folderId=\"13s5wep_gYYVCroQcFB6nJHMWz8V2Onsr\" // public folder\n        folderId,\n      },\n    });\n\n  addMarkers = (files, visible = true, folderId) => {\n    if (!window.AMap) {\n      alert(\n        \"We are about to convert location from GPS to AMap, but AMap still not loaded!\"\n      );\n      return;\n    }\n\n    const lnglats = [];\n    files.forEach((file) => {\n      lnglats.push([\n        file.imageMediaMetadata.location.longitude,\n        file.imageMediaMetadata.location.latitude,\n      ]);\n    });\n\n    debug(\"window.AMap.convertFrom() loading\");\n    window.AMap.convertFrom(lnglats, \"gps\", (status, result) => {\n      debug(\"window.AMap.convertFrom\", status, result);\n\n      if (result.info === \"ok\") {\n        const photos = result.locations.map((resLnglat, index) => {\n          // resLnglat={Q: 39.877753363716\n          // R: 116.21148084852501\n          // lat: 39.877753\n          // lng: 116.211481}\n          return {\n            lnglat: resLnglat,\n            thumbnail: files[index].thumbnailLink,\n            webViewLink: files[index].webViewLink,\n          };\n        });\n\n        photos.forEach((photo) => {\n          const marker = this.genMarker(photo, folderId, visible);\n          marker.content = `<div><a target=\"_blank\" href=\"${photo.webViewLink}\"><img src=\"${photo.thumbnail}\"></a></div>`;\n          this.allMarkers.push(marker);\n          const markerClick = (event) => {\n            var infoWindow = new window.AMap.InfoWindow({\n              offset: new window.AMap.Pixel(0, -30),\n            });\n            infoWindow.setContent(event.target.content);\n            infoWindow.open(this.map, event.target.getPosition());\n          };\n          marker.on(\"click\", markerClick);\n        });\n\n        // Fitbounds to all the markers\n        this.map.setFitView();\n      }\n    });\n  };\n\n  removeMarkersInFolder = (folderId) => {\n    const markersInFolder = [];\n    const markers = this.map.getAllOverlays(\"marker\");\n    markers.forEach((marker) => {\n      if (marker.getExtData().folderId === folderId) {\n        markersInFolder.push(marker);\n      }\n    });\n    this.map.remove(markersInFolder);\n  };\n\n  removeAllMarkers = () => {\n    this.map.remove(this.allMarkers);\n  };\n\n  render() {\n    const { defaultCenter, defaultZoom } = this.props;\n\n    const events = {\n      created: (instance) => {\n        this.props.onMapInstanceCreated(instance);\n        this.map = instance;\n      },\n      /**\n       * @param {MapsEvent} mapsEvent\n       */\n      click: (mapsEvent) => {\n        debug(\"AMap event: click\", mapsEvent);\n        // @type {LngLat} https://lbs.amap.com/api/javascript-api/reference/core#LngLat\n        const lngLat = mapsEvent.lnglat;\n        console.log(`You click on the AMap, lngLat: ${lngLat.toString()}`);\n      },\n    };\n\n    // Add onInstanceCreated prop to <Map> will cause events.created not fired.\n    return (\n      <div className=\"amap-wrapper\">\n        <Map\n          amapkey={process.env.REACT_APP_AMAP_API_KEY}\n          version=\"1.4.15\"\n          center={defaultCenter}\n          zoom={defaultZoom}\n          events={events}\n        />\n      </div>\n    );\n  }\n}\n","import React from \"react\";\nimport { Radio } from \"antd\";\nimport debugModule from \"debug\";\n\nconst debug = debugModule(\"photo-map:src/Application/MapSelector.jsx\");\n\nconst radioStyle = {\n  display: \"block\",\n  height: \"30px\",\n  lineHeight: \"30px\",\n};\n\nexport default function MapSelector(props) {\n  debug(\"render()\");\n\n  const { selectedMap } = props;\n\n  const handleChange = (event) => {\n    const { value } = event.target;\n    props.onChange && props.onChange(value);\n  };\n\n  return (\n    <div className=\"map-selector\">\n      <h3>Choose Map:</h3>\n      <Radio.Group onChange={handleChange} value={selectedMap}>\n        <Radio style={radioStyle} value=\"amap\">\n          AMap\n        </Radio>\n        <Radio style={radioStyle} value=\"google\">\n          Google Maps\n        </Radio>\n      </Radio.Group>\n    </div>\n  );\n}\n","import React, { Component } from \"react\";\nimport ReactGA from \"react-ga\";\n\nimport HelpTip from \"../components/HelpTip\";\n\nexport default class Title extends Component {\n  render() {\n    return (\n      <span>\n        Photo Map{\" \"}\n        <HelpTip>\n          <div>\n            Please read the{\" \"}\n            <ReactGA.OutboundLink\n              eventLabel=\"HowToUse\"\n              to=\"https://github.com/photo-map/photo-map.github.io/blob/master/help/HOW_TO_USE.md#how-to-use\"\n              target=\"_blank\"\n            >\n              How to use\n            </ReactGA.OutboundLink>{\" \"}\n            document in GitHub repo.\n          </div>\n        </HelpTip>\n      </span>\n    );\n  }\n}\n","import ReactGA from \"react-ga\";\nimport debugModule from \"debug\";\n\nconst debug = debugModule(\n  \"photo-map:src/Application/helpers/renderGoogleLoginBtn.js\"\n);\n\nexport default function renderGoogleLoginBtn(props, auth2) {\n  debug(\"renderGoogleLoginBtn()\", props, auth2);\n\n  /**\n   * User signed in by clicking button.\n   * @param {gapi.auth2.GoogleUser} user\n   */\n  const onSuccess = (user) => {\n    debug(\"onSuccess()\", user);\n    debug(\"User signed in by clicking button.\");\n    ReactGA.event({\n      category: \"Auth\",\n      action: \"User login\",\n    });\n    props.onLoginSuccess(user);\n  };\n  const onFailure = (error) => {\n    debug(\"onFailure(), error:\", error);\n  };\n  /**\n   * @param {bool} a\n   */\n  const signinChanged = (a) => {\n    debug(\"signinChanged()\", a);\n  };\n  /**\n   * @param {gapi.auth2.GoogleUser} user\n   */\n  const userChanged = (user) => {\n    debug(\"userChanged()\", user);\n  };\n  auth2.attachClickHandler(\n    \"custom-google-login-button\",\n    {},\n    onSuccess,\n    onFailure\n  );\n\n  auth2.isSignedIn.listen(signinChanged);\n  // API: https://developers.google.com/identity/sign-in/web/reference#googleauthcurrentuserlistenlistener\n  auth2.currentUser.listen(userChanged); // This is what you use to listen for user changes\n\n  window.gapi.load(\"signin2\", () => {\n    debug(\"signin2 loaded\");\n\n    /**\n     * User already signed in when rendering button.\n     * @param {gapi.auth2.GoogleUser} user\n     */\n    const handleSuccess = (user) => {\n      debug(\"handleSuccess()\", user);\n      debug(\"User already signed in when rendering button.\");\n      props.onLoginSuccess(user);\n    };\n    const handleFailure = (a, b, c) => {\n      debug(\"handleFailure\", a, b, c);\n    };\n\n    // API https://developers.google.com/identity/sign-in/web/reference#gapisignin2renderid_options\n    window.gapi.signin2.render(\"custom-google-login-button\", {\n      onsuccess: handleSuccess,\n      onfailure: handleFailure,\n    });\n\n    props.onRenderFinish();\n  });\n}\n","import React, { Component } from \"react\";\nimport ReactGA from \"react-ga\";\nimport debugModule from \"debug\";\n\nimport { gapiOAuthClientId } from \"../config\";\nimport renderGoogleLoginBtn from \"../helpers/renderGoogleLoginBtn\";\n\nconst debug = debugModule(\n  \"photo-map:src/Application/MenuDrawer/GoogleLogin.jsx\"\n);\nconst scopeNeeded = [\n  \"profile\",\n  \"email\",\n  \"https://www.googleapis.com/auth/drive\",\n  // \"https://www.googleapis.com/auth/photoslibrary.readonly\",\n].join(\" \");\n\n/**\n * Google Login Button\n * ## References\n * - https://developers.google.com/identity/sign-in/web/build-button#customizing_the_automatically_rendered_sign-in_button_recommended\n * - https://stackoverflow.com/questions/31610461/using-google-sign-in-button-with-react\n * - https://developers.google.com/identity/sign-in/web/reference#gapisignin2renderid_options\n */\nexport default class GoogleLogin extends Component {\n  state = {\n    gapiAuth2Loaded: false,\n    signedIn: false,\n  };\n\n  componentDidMount() {\n    const gapiAuth2Loaded = () => {\n      debug(\"auth2 loaded\");\n\n      this.setState({ gapiAuth2Loaded: true });\n\n      const auth2 = window.gapi.auth2.init({\n        client_id: gapiOAuthClientId,\n        scope: scopeNeeded,\n      });\n\n      renderGoogleLoginBtn(\n        {\n          onLoginSuccess: (user) => {\n            this.setState({ signedIn: true });\n            this.props.onLoginSuccess(user);\n          },\n          onRenderFinish: this.props.onRenderFinish,\n        },\n        auth2\n      );\n    };\n\n    // https://github.com/google/google-api-javascript-client/blob/master/docs/reference.md#----gapiloadlibraries-callbackorconfig------\n    window.gapi.load(\"auth2\", gapiAuth2Loaded);\n  }\n\n  handleSignOutBtnClick = () => {\n    // https://developers.google.com/identity/sign-in/web/reference#gapiauth2getauthinstance\n    const googleAuth = window.gapi.auth2.getAuthInstance();\n    googleAuth.signOut().then(() => {\n      debug(\"User signed out by clicking button.\");\n      ReactGA.event({\n        category: \"Auth\",\n        action: \"User logout\",\n      });\n      this.setState({ signedIn: false });\n      this.props.onSignedOut();\n    });\n  };\n\n  renderLoginBtn = () => {\n    const googleAuth = window.gapi.auth2.getAuthInstance();\n\n    if (googleAuth && googleAuth.isSignedIn.get()) {\n      // Already signed in, hide login button.\n      return null;\n    }\n\n    // TODO need to call gapi to render the button again on this empty tag\n    return <div id=\"custom-google-login-button\" />;\n  };\n\n  renderSignOutBtn = () => {\n    if (!this.state.signedIn) {\n      return null;\n    }\n    return <button onClick={this.handleSignOutBtnClick}>Sign out</button>;\n  };\n\n  render() {\n    if (!this.state.gapiAuth2Loaded) {\n      return <div>The \"auth2\" gapi library doesn't loaded yet.</div>;\n    }\n\n    return (\n      <div>\n        <h3>Google Login</h3>\n        {this.renderLoginBtn()}\n        {this.renderSignOutBtn()}\n      </div>\n    );\n  }\n}\n","export const gaTrackId = \"UA-48270916-5\";\nexport const gapiOAuthClientId =\n  \"769870583187-6p6tvl5nh7qc8m9hrgqh285siqm9oc37.apps.googleusercontent.com\";\n","import {\n  localStorageKeyPrivateFolderVisible,\n  localStorageKeyPublicFolders,\n} from \"./FolderList\";\nimport { localStorageKeySelectedMap } from \"../Map\";\n\n/**\n * Convert folder web link: https://drive.google.com/drive/folders/13s5wep_gYYVCroQcFB6nJHMWz8V2Onsr?usp=sharing\n * to folder ID: 13s5wep_gYYVCroQcFB6nJHMWz8V2Onsr\n * @param {string} link\n * @returns {string}\n */\nexport const link2Id = (link) =>\n  link\n    .replace(\"https://drive.google.com/drive/folders/\", \"\")\n    .replace(\"?usp=sharing\", \"\");\n\nexport const exportConfig = (localStorage) => {\n  const storageObj = {\n    [localStorageKeyPrivateFolderVisible]: localStorage.getItem(\n      localStorageKeyPrivateFolderVisible\n    ),\n    [localStorageKeyPublicFolders]: localStorage.getItem(\n      localStorageKeyPublicFolders\n    ),\n    [localStorageKeySelectedMap]: localStorage.getItem(\n      localStorageKeySelectedMap\n    ),\n  };\n  const dataStr =\n    \"data:text/json;charset=utf-8,\" +\n    encodeURIComponent(JSON.stringify(storageObj, null, 2));\n  return dataStr;\n};\n\nexport const importConfig = (localStorage, configObj) => {\n  localStorage.setItem(\n    localStorageKeyPrivateFolderVisible,\n    configObj[localStorageKeyPrivateFolderVisible]\n  );\n  localStorage.setItem(\n    localStorageKeyPublicFolders,\n    configObj[localStorageKeyPublicFolders]\n  );\n  localStorage.setItem(\n    localStorageKeySelectedMap,\n    configObj[localStorageKeySelectedMap]\n  );\n};\n","import React, { Component } from \"react\";\nimport { Button } from \"antd\";\n\nimport { exportConfig, importConfig } from \"./helpers\";\n\nexport default class ConfigSection extends Component {\n  constructor(props) {\n    super(props);\n    this.downloadRef = React.createRef();\n    this.inputRef = React.createRef();\n    this.state = {\n      href: \"{}\",\n    };\n  }\n\n  handleDownload = () => {\n    this.setState({ href: exportConfig(localStorage) }, () => {\n      if (this.downloadRef && this.downloadRef.current) {\n        this.downloadRef.current.click();\n      } else {\n        alert(\"downloadRef or node is undefined!\");\n      }\n    });\n  };\n\n  handleImport = () => {\n    if (this.inputRef && this.inputRef.current) {\n      this.inputRef.current.click();\n    } else {\n      alert(\"inputRef or node is undefined!\");\n    }\n  };\n\n  // Solution A: https://stackoverflow.com/a/27116209/4685522\n  // Solution B: https://stackoverflow.com/a/48176648/4685522\n  handleChange = async (event) => {\n    const file = event.target.files[0];\n    if (file) {\n      const data = await new Response(file).text();\n      var obj = JSON.parse(data);\n      importConfig(localStorage, obj);\n    }\n  };\n\n  render() {\n    return (\n      <div>\n        <h3>Import/Export application config</h3>\n        <a\n          ref={this.downloadRef}\n          href={this.state.href}\n          style={{ display: \"none\" }}\n          download=\"photo-map-config.json\"\n        >\n          Download Config File\n        </a>\n        <Button onClick={this.handleDownload}>Export</Button>\n        <input\n          ref={this.inputRef}\n          className=\"import-config-file-helper\"\n          type=\"file\"\n          style={{ display: \"none\" }}\n          onChange={this.handleChange}\n        />\n        <Button onClick={this.handleImport}>Import</Button>\n      </div>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport { Drawer, Button, Input, message } from \"antd\";\nimport PubSub from \"pubsub-js\";\nimport debugModule from \"debug\";\n\nimport HelpTip from \"../components/HelpTip\";\nimport { ADD_MARKERS_TOPIC } from \"../Map/AMap\";\nimport { getPhotosInPublicFolder } from \"../Map/helpers\";\nimport MapSelector from \"../Map/MapSelector\";\n\nimport FolderList, { ADD_PUBLIC_FOLDER_TOPIC, decode } from \"./FolderList\";\nimport Title from \"./Title\";\nimport GoogleLogin from \"./GoogleLogin\";\nimport ConfigSection from \"./ConfigSection\";\nimport { link2Id } from \"./helpers\";\n\nconst debug = debugModule(\"photo-map:src/Application/MenuDrawer/index.jsx\");\n\n// Open it\nexport const OPEN_DRAWER_TOPIC = \"menudrawer.open\";\n// Open or close it according to the state\nexport const OPEN_CLOSE_DRAWER_TOPIC = \"menudrawer.openclose\";\n\nexport default class MenuDrawer extends Component {\n  state = {\n    drawerVisible: false,\n    publicFolderLink: \"\",\n    loading: false,\n  };\n\n  componentDidMount() {\n    this.addSubscribers();\n  }\n\n  componentWillUnmount() {\n    this.removeSubscribers();\n  }\n\n  handleDrawerClose = () => {\n    this.setVisible(false);\n  };\n\n  handlePublicFolderLinkChange = (event) => {\n    this.setState({ publicFolderLink: event.target.value });\n  };\n\n  handlePublicFolderInputPressEnter = () => {\n    this.loadPublicFolderAndAddMarkers();\n  };\n\n  handleLoadPublicFolderBtnClick = () => {\n    this.loadPublicFolderAndAddMarkers();\n  };\n\n  loadPublicFolderAndAddMarkers = async () => {\n    if (this.state.loading) {\n      message.warn(\n        \"Previous public folder is loading now, please wait a moment.\"\n      );\n      return;\n    }\n\n    const folderId = link2Id(this.state.publicFolderLink);\n\n    // Check whether folder exists\n    if (decode()[folderId] !== undefined) {\n      message.warn(\"There is an existing public folder!\");\n      return;\n    }\n\n    let folderInfo = null;\n    try {\n      this.setState({ loading: true });\n      folderInfo = await getPhotosInPublicFolder(folderId);\n      this.setState({ loading: false });\n    } catch (error) {\n      console.error(\"failed to get photos in a public folder, error:\", error);\n      message.error(error.message);\n      this.setState({ loading: false });\n      return;\n    }\n\n    PubSub.publish(ADD_PUBLIC_FOLDER_TOPIC, folderInfo);\n    PubSub.publish(ADD_MARKERS_TOPIC, folderInfo);\n  };\n\n  setVisible = (visible) => {\n    this.setState({ drawerVisible: visible });\n  };\n\n  openDrawerSubscriber = (msg) => {\n    this.setVisible(true);\n  };\n\n  openCloseDrawerSubscriber = (msg) => {\n    this.setVisible(!this.state.drawerVisible);\n  };\n\n  addSubscribers = () => {\n    this.openDrawerToken = PubSub.subscribe(\n      OPEN_DRAWER_TOPIC,\n      this.openDrawerSubscriber\n    );\n    this.openCloseDrawerToken = PubSub.subscribe(\n      OPEN_CLOSE_DRAWER_TOPIC,\n      this.openCloseDrawerSubscriber\n    );\n  };\n\n  removeSubscribers = () => {\n    PubSub.unsubscribe(this.openDrawerToken);\n  };\n\n  render() {\n    debug(\"render()\");\n\n    const { selectedMap } = this.props;\n    const { drawerVisible, publicFolderLink } = this.state;\n\n    return (\n      <div className=\"menu-drawer\">\n        <Drawer\n          className=\"menu-drawer\"\n          width={512}\n          title={<Title />}\n          placement=\"left\"\n          closable={false}\n          forceRender\n          visible={drawerVisible}\n          onClose={this.handleDrawerClose}\n        >\n          <MapSelector\n            selectedMap={selectedMap}\n            onChange={this.props.onMapChange}\n          />\n          <GoogleLogin\n            onLoginSuccess={this.props.onLoginSuccess}\n            onRenderFinish={this.props.onRenderFinish}\n            onSignedOut={this.props.onSignedOut}\n          />\n          <div>\n            <div>\n              Public folder link:{\" \"}\n              <HelpTip>\n                <div>\n                  <div>Please fill the public folder link. For example:</div>\n                  <div>\n                    https://drive.google.com/drive/folders/13s5wep_gYYVCroQcFB6nJHMWz8V2Onsr?usp=sharing\n                  </div>\n                </div>\n              </HelpTip>\n            </div>\n            <Input\n              value={publicFolderLink}\n              onChange={this.handlePublicFolderLinkChange}\n              onPressEnter={this.handlePublicFolderInputPressEnter}\n            />\n            <Button\n              disabled={this.state.loading}\n              onClick={this.handleLoadPublicFolderBtnClick}\n            >\n              Load\n            </Button>\n            <hr />\n            <FolderList />\n            <hr />\n            <ConfigSection />\n          </div>\n        </Drawer>\n      </div>\n    );\n  }\n}\n","import PubSub from \"pubsub-js\";\nimport ReactGA from \"react-ga\";\n\nimport { gaTrackId } from \"./config\";\nimport { OPEN_CLOSE_DRAWER_TOPIC } from \"./MenuDrawer\";\nimport { SWITCH_MAP_TOPIC } from \"./Map\";\n\nexport const initGa = () => {\n  ReactGA.initialize(gaTrackId, {\n    // debug: true,\n  });\n};\n\nexport const registerShortcut = () => {\n  document.addEventListener(\n    \"keyup\",\n    (event) => {\n      switch (event.code) {\n        // Open or close left menu\n        case \"KeyM\": {\n          PubSub.publish(OPEN_CLOSE_DRAWER_TOPIC);\n          break;\n        }\n        // Switch AMap and Google Maps\n        case \"KeyS\": {\n          PubSub.publish(SWITCH_MAP_TOPIC);\n          break;\n        }\n        default: {\n          break;\n        }\n      }\n    },\n    false\n  );\n};\n\n/**\n * After gapi.client is loaded by gapi.load('client'), then you could use method like:\n * ```\n * gapi.client.request()\n * ```\n * https://github.com/google/google-api-javascript-client/blob/master/samples/simpleRequest.html\n * @returns {Promise<undefined>}\n */\nexport const initGapiClient = () =>\n  new Promise((resolve, reject) => {\n    window.gapi.load(\"client\", () => {\n      resolve();\n    });\n  });\n","import React from \"react\";\n\nexport default function Warning() {\n  return (\n    <div className=\"website-warning\">\n      <p>Google API not loaded!</p>\n      <p>Maybe you need to turn off the Adblock Plus for this website.</p>\n      <p>\n        If you still have problem, please{\" \"}\n        <a\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n          href=\"https://github.com/photo-map/photo-map.github.io/issues\"\n        >\n          raise an issue\n        </a>{\" \"}\n        in the GitHub project.\n      </p>\n    </div>\n  );\n}\n","import React, { Component } from \"react\";\n\nimport { initGa, initGapiClient, registerShortcut } from \"./init\";\nimport Warning from \"./Warning\";\nimport Map from \"./Map\";\n\n// Styles for antd\nimport \"antd/dist/antd.css\";\n// Styles for application\nimport \"./index.css\";\n\nexport default class Application extends Component {\n  state = {\n    gapiLoaded: false, // Google API loaded or not\n    gapiClientLoading: false,\n  };\n\n  componentDidMount() {\n    this.initApplication();\n  }\n\n  initApplication = () => {\n    initGa();\n\n    // window.gapiLoadedFlag is defined in public/index.html\n    // This flag is true only when Google API's platform.js is loaded, .\n    if (window.gapiLoadedFlag) {\n      this.setState({\n        gapiLoaded: true,\n      });\n      this.loadGapiClient();\n    }\n\n    registerShortcut();\n  };\n\n  loadGapiClient = () => {\n    this.setState({\n      gapiClientLoading: true,\n    });\n    initGapiClient().then(() => {\n      this.setState({\n        gapiClientLoading: false,\n      });\n    });\n  };\n\n  render() {\n    if (!this.state.gapiLoaded) {\n      return <Warning />;\n    }\n\n    if (this.state.gapiClientLoading) {\n      return <div>gapi client lib is loading</div>;\n    }\n\n    return (\n      <div className=\"application\">\n        <Map />\n      </div>\n    );\n  }\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\n// import App from './App';\nimport Application from \"./Application\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nReactDOM.render(\n  // <React.StrictMode>\n  //   <App />\n  // </React.StrictMode>,\n  <Application />,\n  document.getElementById(\"root\")\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}